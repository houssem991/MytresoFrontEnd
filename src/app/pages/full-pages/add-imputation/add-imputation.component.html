<!--Registration Page Starts-->
<section id="addimputation">
  <div class="row auth-height full-height-vh m-0">
    <div class="col-12 d-flex align-items-center justify-content-center">
      <div class="card overflow-hidden">
        <div class="card-content">
          <div class="card-body">
            <div class="row m-0">
              <div class="col-lg-12 col-md-12 ">
                <h4 class="card-title mb-2">Ajouter une imputation</h4>
                <p>Veuillez remplir ce formulaire.</p>
                <ngb-alert type="danger" class="mb-2" [dismissible]="false" *ngIf="isSignUpFailed" (close)="isSignUpFailed = false">
                  <div class="alert-icon-left">
                    <i class="ft-thumbs-down mr-2"></i>
                    <span>{{errorMessage}}</span>
                  </div>
                </ngb-alert>
                <ngb-alert type="success" class="mb-2" [dismissible]="false" *ngIf="isSuccessful" (close)="isSuccessful = false">
                  <div class="alert-icon-left">
                    <i class="ft-thumbs-up mr-2"></i>
                    <span>imputation ajoutée avec succes !</span>
                  </div>
                </ngb-alert>
                <ngx-spinner></ngx-spinner>
                <form [formGroup]="imputationForm">
                  <table class="table table-hover table-responsive">
                    <thead>
                    <tr>
                      <th style="width: 10%"></th>
                      <th class="text-primary" scope="col">N°Piece</th>
                      <th class="text-primary" scope="col">N°Tiers</th>
                      <th class="text-primary" scope="col">Valide</th>
                      <th class="text-primary" scope="col">Date de document</th>
                      <th class="text-primary" scope="col">Etat</th>
                      <th class="text-primary" scope="col">Net A Payer</th>
                      <th class="text-primary" scope="col">Montant Regle</th>
                      <th class="text-primary" scope="col">Reste A Payer</th>

                    </tr>
                    </thead>
                    <tbody>
                    <ng-container *ngFor="let doc of facture; let i = index ; trackBy: trackById">

                      <tr>
                        <td>   <input
                          type="checkbox"
                          [checked]="doc.selected"
                          [disabled]="doc.disabled"
                          (change)="onCheckboxChange(i, $event.target.checked)"
                        /></td>
                        <td>{{doc.id}}</td>
                        <td>{{doc.clientCode}}</td>
                        <td>{{doc.valide}}</td>
                        <td>{{doc.documentDate}}</td>
                        <td>{{doc.etat}}</td>
                        <td>{{doc.netAPayer}}</td>
                        <td>{{doc.montantRegle}}</td>
                        <td>{{doc.resteAPayer}}</td>

                      </tr>
                      <!-- ngIf vérifie si l'index ouvert correspond à l'index de la ligne cliquée -->
                    </ng-container>
                    </tbody>
                  </table>
                  <p>Total Selection: {{montantselect}} Solde Restant : {{soldeRestant}}</p>
                  <div class="form-group" *ngIf="reglement?.n_Reglement==1 else template">
                    <ng-select [items]="caisse" bindLabel="libelle" placeholder="choisir une caisse" bindValue="id" formControlName="idcaisse" >
                    </ng-select>
                  </div>
                  <ng-template #template>
                    <div class="form-group">
                      <ng-select [items]="banque" bindLabel="nom" placeholder="choisir une banque" bindValue="id" formControlName="idbanque" >
                      </ng-select>
                    </div>
                  </ng-template>


                  <div class="d-flex justify-content-between flex-sm-row flex-column">
                    <a class="btn btn-primary" (click)="onSubmit()">ajouter</a>
                  </div>
                </form>


              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!--Registration Page Ends-->
